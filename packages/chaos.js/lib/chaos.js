#!/usr/bin/env node

parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"jTSK":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function u(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(i,u)}l((r=r.apply(e,n||[])).next())})},n=this&&this.__generator||function(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=this;Object.defineProperty(exports,"__esModule",{value:!0});var o=t(require("yargs")),a=function(){return o.default.option("global",{alias:"g",describe:"Configure pando globally",type:"boolean"}).help().version(!1)},i=function(t){return e(r,void 0,void 0,function(){return n(this,function(e){return[2]})})};exports.daemon={command:"daemon",desc:"Launch Chaos Machine daemon",builder:a,handler:i};
},{}],"IugF":[function(require,module,exports) {
"use strict";function e(e){for(var r in e)exports.hasOwnProperty(r)||(exports[r]=e[r])}Object.defineProperty(exports,"__esModule",{value:!0}),e(require("./daemon"));
},{"./daemon":"jTSK"}],"iiaA":[function(require,module,exports) {
var s=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s};const e=require("@xavier.seignard/ssp"),t=require("events"),i={1:{value:5,display:"5€"},2:{value:10,display:"10€"},3:{value:20,display:"20€"},4:{value:50,display:"50€"},5:{value:100,display:"100€"},6:{value:500,display:"500€"}};class r extends t{constructor(t){if(super(),!t.port)throw new Error("[Cash] Please specify a serial port!");this.ssp=new e({device:t.port,type:"nv10usb",currencies:[1,1,1,1,1,1]}),this.ssp.init(!0,()=>{this.ssp.on("ready",()=>{this.ssp.enable(()=>this.emit("ready"))}),this.ssp.on("read_note",e=>{e>0&&this.emit("read",s({id:e},i[e]))}),this.ssp.on("credit_note",e=>{e>0&&this.emit("accepted",s({id:e},i[e]))})})}close(){this.ssp.port&&this.ssp.port.isOpened&&this.ssp.disable()}}module.exports=r;
},{}],"qPhT":[function(require,module,exports) {
const r=require("serialport"),e=require("qrcode"),t=require("thermalprinter"),i=require("events");class s extends i{constructor(e){if(super(),!e.port)throw new Error("[Printer] Please specify a serial port!");this.serialPort=new r(e.port,{baudRate:19200}),this.serialPort.on("open",()=>{this.printer=new t(this.serialPort),this.printer.on("ready",()=>this.emit("ready"))})}print(r){e.toString(r,(e,t)=>{const i=t.split("\n");this.printer.setLineSpacing(0),this.printer.center(),i.forEach(r=>this.printer.printLine(r.substring(2,r.length-2))),this.printer.writeCommands([27,50]),this.printer.lineFeed(2),this.printer.print(()=>this.emit("done",r))})}close(){this.serialPort&&this.serialPort.isOpened&&this.serialPort.close()}}module.exports=s;
},{}],"E9SO":[function(require,module,exports) {
const o=require("onoff").Gpio;class i{constructor(i){if(!i.pin)throw new Error("[Relay] Please specify a pin!");o.accessible?this.gpio=new o(i.pin,"out"):this.gpio={writeSync:o=>console.log(`writing: ${o}`),unexport:()=>console.log("unexporting")}}turnOn(){this.gpio.writeSync(1)}turnOff(){this.gpio.writeSync(0)}close(){o.accessible&&this.gpio.unexport()}}module.exports=i;
},{}],"cIy5":[function(require,module,exports) {
const e=require("lcd"),s=require("events");class t extends s{constructor(s){if(super(),!s.rs||!s.e||!s.data||4!==s.data.length)throw new Error("[Lcd] Please specifiy the correct pins!");this.lcd=new e(s),this.lcd.on("ready",()=>this.emit("ready"))}write(e,s){this.lcd.setCursor(0,0),this.lcd.print(e,e=>s&&s(e))}close(){this.lcd&&this.lcd.close()}}module.exports=t;
},{}],"K/kH":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var i=o(require("url-parse")),a=o(require("truffle-contract")),u=o(require("ipfs-api")),c=o(require("eth-crypto")),s=o(require("web3")),f=o(require("truffle-hdwallet-provider")),l=o(require("events")),p=o(require("util")),h={IPFS:"https://ipfs.infura.io:5001",ETHEREUM:"https://mainnet.infura.io/v3/ab05225130e846b28dc1bb71d6d96f09",MNEMONIC:"journey nice rather ball theme used uncover gate pond rifle between state",ADDRESS:"0x7e8dcb7432b8356635f2820b8e92fa6d760609fe"},d=function(o){function l(t){var e=void 0===t?{}:t,r=e.ipfs,n=void 0===r?h.IPFS:r,c=e.ethereum,s=void 0===c?h.ETHEREUM:c,l=e.mnemonic,p=void 0===l?h.MNEMONIC:l,d=e.address,b=void 0===d?h.ADDRESS:d,v=o.call(this)||this,y=i.default(n);return v.ipfs=u.default(y.hostname,y.port,{protocol:y.protocol.slice(0,-1)}),v.mnemonic=p,v.provider=new f.default(p,s),v.abstraction=a.default(require("@chaosmachine/core/build/contracts/Chaos.json")),v.abstraction.setProvider(v.provider),v.address=b,v}return t(l,o),l.create=function(t){return r(this,void 0,Promise,function(){var e,r,o;return n(this,function(n){switch(n.label){case 0:return e=new l(t),r=new s.default(e.provider),[4,p.default.promisify(r.eth.getAccounts)()];case 1:return o=n.sent(),e.abstraction.defaults({from:o[0]}),e.contract=e.abstraction.at(e.address),e.contract.TokenGranted({},{fromBlock:"latest",toBlock:"latest"}).watch(function(t,r){t?e.emit("error",t):e.emit("tokenGranted",r)}),[2,e]}})})},l.prototype.generateToken=function(){return c.default.createIdentity()},l.prototype.registerToken=function(t,o){return r(this,void 0,Promise,function(){var r;return n(this,function(n){switch(n.label){case 0:return[4,this.contract.grantToken.estimateGas(t)];case 1:return r=n.sent(),[4,this.contract.grantToken(t,e({gas:2*r},o))];case 2:return[2,n.sent()]}})})},l}(l.default);exports.default=d;
},{}],"7QCb":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("yargs")),i=r(require("./commands")),o=t.default.usage("chaos <command>").command(i.daemon).demandCommand(1,"No command provided").strict().help().alias("h","help").argv,n=require("./devices/cash"),s=require("./devices/printer"),a=require("./devices/relay"),u=require("./devices/lcd"),c=e(require("./machine")),d=new c.default;process.on("SIGINT",function(){return process.exit(0)}),process.on("uncaughtException",function(e){console.log(e.stack),setTimeout(function(){process.exit(1)},500)});
},{"./commands":"IugF","./devices/cash":"iiaA","./devices/printer":"qPhT","./devices/relay":"E9SO","./devices/lcd":"cIy5","./machine":"K/kH"}]},{},["7QCb"], null)
//# sourceMappingURL=/chaos.map
